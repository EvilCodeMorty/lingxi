# 灵溪

**这是一个基于 Koa 和 MySQL 构建的跨多领域的后端系统，旨在为用户提供便捷的互联网通道和社交,我们为商家提供了用户管理、商品管理和订单管理等功能，同时提供可视化分析店铺情况的工具。**

## 系统架构

**本系统采用前后端分离的架构，前端使用 Vue.js 框架，后端使用 koa 框架和 mysql 数据库。**

**前端和后端通过 RESTful API 进行通信，前端发送 HTTP 请求，后端返回 JSON 格式的数据。**

## 系统功能

**本系统提供了以下功能：**

- **用户管理：包括用户注册、登录、修改密码、修改个人信息等操作。**
- **商品管理：包括商品列表、商品详情、商品分类、商品搜索等操作。**
- **订单管理：包括订单列表、订单详情、订单状态、订单支付等操作。**
- **朋友管理: 包括好友列表、在线群聊、朋友圈等操作。**
- **运营管理: 整体的运营可视化分析。**
- **目前仅限此类功能,后期视情况补全商家在线聊天和朋友圈相关功能;**

## 系统结构

**本系统的目录结构如下：**

**├── src //项目主文件;**

**│ ├──app //业务文件夹,用于设置一些框架功能**

**│ │ ├──errorHandler //统一错误处理;**

**│ │ └── index //项目业务文件主入口;**

**│ ├──config //默认配置文件;**

**│ │ ├──env //环境变量配置文件;**

**│ │ ├──log //日志配置文件;;**

**│ │ └──config.default //默认配置文件;**

**│ ├──constant //常量配置文件;**

**│ │ ├──error //错误类型文件;**

**│ │ │ ├──default.error.type //默认错误类型文件;**

**│ │ │ ├──email.error.type //邮件相关的错误类型文件;**

**│ │ │ ├──user.error.type //用户相关的错误类型文件;**

**│ │ │ ├──verification.code.error.type //验证码相关的错误类型文件;**

**│ │ │ └──verify.parameter.error.type //参数校验相关的错误类型文件;**

**│ │ └──config.default //默认配置文件;**

**│ ├──controllers //控制器文件;**

**│ │ │ ├──default.controller //默认控制器文件;**

**│ │ │ └──user.controller //用户相关的控制器文件;**

**│ ├──db //数据库设置文件;**

**│ │ └──sequelize //sequelize 连接数据库配置文件;**

**│ ├──design //个人文件,放置一些设计思路或无用的文件,可删除;**

**│ │ ├──model //数据库相关的设计思路文件;**

**│ │ ├──echidna.sql //数据库文件包,可直接导入数据库;**

**│ │ └──koa-modules //项目框架相关包;**

**│ ├──lib //共享包文件;**

**│ ├──logs //日志文件;**

**│ │ └──error //错误日志文件,根据年份月份存储错误日志;**

**│ │ │ └──echidna_2023year_8month_error.log //2023 年 8 月错误日志;**

**│ ├──middlewares //中间件文件;**

**│ │ ├──auth.middleware //鉴权相关的中间件;**

**│ │ ├──default.middleware //一些默认的中间件;**

**│ │ ├──user.middleware //用户相关的中间件;**

**│ │ └──verify.parameter.middleware //参数校验相关的中间件;**

**│ ├──models //数据库模型文件;**

**│ │ ├──user.model //用户数据库模型;**

**│ │ └──verification.code.model //验证码数据库模型;**

**│ ├──public //静态资源文件;**

**│ ├──routes //路由文件;**

**│ │ ├──user.route //用户路由;**

**│ │ └──default.route //默认路由;**

**│ ├──services //数据库操作文件;**

**│ │ ├──user.service //用户相关的数据库操作;**

**│ │ └──default.service //默认数据库操作;**

**│ ├──utils //通用工具;**

**│ ├──validators //校验器文件**

**│ └── main //入口文件;**

**├── .env //项目环境变量文件;**

**├── app // 应用入口文件;**

**├── envSubstitute //env 对应配置文件,详情参考文件内容;**

**├── README.md //说明文档;**

**└── tsconfig.json //ts 配置文件;**

## 系统安装

1. **安装 Node.js 和 npm。**

2. **安装 mysql 数据库，并创建一个名为`emilia`的数据库。**

3. **克隆本仓库到本地。**

4. **在项目根目录下执行以下命令安装依赖：**

   **npm install**

5. **在项目根目录下执行以下命令启动服务器：**

   **npm run dev**

6. **访问`http://localhost:12138`即可查看系统。**

## 系统配置

**本系统的配置文件为`.env`，包括以下配置项：**

- **port**：服务器端口号，默认 12138;
- **Email**: 服务器发送邮件验证码的邮箱,自行配置;
- **Email_password**: 服务器发送邮箱验证码邮箱的权限码,在自己邮箱设置中申请;
- **mysql_db**: 数据库名,自行配置;
- **\*mysql_user**: 数据库用户名,自行配置;\*
- **mysql_password**: 数据库用户密码,自行配置;
- **mysql_port**: 数据库端口号,自行配置;
- **mysql_host**: 数据库地址,自行配置;
- **mysql_type**: 数据库类型,自行配置;
- **根目录下有个 envSubstitute.ts 文件,是.env 文件的配置说明文件,在创建.env 文件以后,根据说明文件自行添加环境变量;**

## 系统使用

**本系统的 API 文档可以参考`routes`目录下的路由文件或者使用在线的 Apifox 文档。**

**[Apifox - 接口文档分享](https://apifox.com/apidoc/project-3036194)**

**所有需要用户信息去获取的东西都需要 token 验证;**

**目前项目还未部署,可自己克隆源码自行部署,或等后期部署通知;**

**在校验用户 token 的时候会有时间校验,如果用户 token 时间不足五个小时,会重新获取新的 token,在这里前端使用的时候需要单独处理,在返回数据中判断是否是所需数据还是新的 token,如果是新的 token 则需要保存新的 token 并重新请求;**

## 系统维护

**本系统的维护包括以下方面：**

- **数据库备份和恢复。**
- **日志管理和监控。**
- **安全管理和漏洞修复。**
- **性能优化和扩展。**

## 作者

- **作者：CodeMorty**
- **邮箱：[CodeMorty@163.com]**

## 版权

**本系统遵循 MIT 开源协议，可以自由使用、修改和分发。**

## 系统说明

**此系统目前仅用于学习交流使用,喜欢可以多点点 star 和推广,另外有什么需要的功能或者意见都可以联系作者。**

---

---
